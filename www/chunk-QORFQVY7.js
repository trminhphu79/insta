import{a as le}from"./chunk-FWEBCYCS.js";import{c as ae}from"./chunk-C2BG3B45.js";import{$ as a,A as b,Ab as ee,B as E,Bb as te,Cb as ie,Da as L,Db as ne,E as T,Ea as p,Fa as D,Fb as N,Ga as W,Gb as oe,I as O,J as l,Lb as re,M as m,Pb as se,U as x,V as v,W as y,X as S,Xa as J,Y as w,Z as d,_ as s,_a as K,aa as u,bb as X,db as Y,ha as M,ib as Z,ja as f,k as V,la as h,n as z,o as G,pa as j,qa as U,ra as A,t as $,ta as Q,u as H,va as F,w as B,x as _,xa as P,za as k}from"./chunk-Y6L6FY7Q.js";import"./chunk-Y2PDZ72K.js";import"./chunk-GOEAN3WI.js";import"./chunk-SNC2IU6J.js";import"./chunk-5SDHGKAM.js";import"./chunk-BXPB4ZAG.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-REYR55MP.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as q}from"./chunk-JHI3MBHO.js";var ge=["inputEl"];function fe(e,t){if(e&1){let r=M();s(0,"ion-icon",4),f("click",function(){b(r);let i=h();return E(i.clearValue())}),a()}}var ce=(()=>{let t=class t{constructor(){this.placeholder=W("T\xECm ki\u1EBFm"),this.focused=D(),this.blurred=D(),this.focusChange=D(),this.value="",this.disabled=!1,this.onChange=()=>{},this.onTouched=()=>{}}writeValue(n){this.value=n??""}registerOnChange(n){this.onChange=n}registerOnTouched(n){this.onTouched=n}setDisabledState(n){this.disabled=n}handleInput(n){let i=n.target.value;this.value=i,this.onChange(i)}focus(){this.disabled||this.inputEl.nativeElement.focus()}onFocusIn(){this.focused.emit(),this.focusChange.emit(!0)}onFocusOut(){this.onTouched(),this.blurred.emit(),this.focusChange.emit(!1)}clearValue(){this.value="",this.onChange(this.value),this.inputEl?.nativeElement.focus()}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=m({type:t,selectors:[["insta-search-input"]],viewQuery:function(i,o){if(i&1&&j(ge,7),i&2){let c;U(c=A())&&(o.inputEl=c.first)}},hostBindings:function(i,o){i&1&&f("focusin",function(){return o.onFocusIn()})("focusout",function(){return o.onFocusOut()})},inputs:{placeholder:[1,"placeholder"]},outputs:{focused:"focused",blurred:"blurred",focusChange:"focusChange"},features:[k([{provide:J,useExisting:$(()=>t),multi:!0}])],decls:4,vars:4,consts:[[1,"border-0","border","rounded-[12px]","relative","flex","shadow-inner"],["slot","start","name","search","aria-hidden","true",1,"text-gray-300","absolute","top-[6px]","left-[10px]","text-[20px]"],[1,"border-0","outline-none","pl-8","pr-14","py-1","h-[32px]","text-base","placeholder:text-sm","w-full",3,"input","placeholder","disabled","value"],["name","close-outline",1,"cursor-pointer","absolute","top-[6px]","right-[10px]","text-[20px]"],["name","close-outline",1,"cursor-pointer","absolute","top-[6px]","right-[10px]","text-[20px]",3,"click"]],template:function(i,o){i&1&&(s(0,"section",0),u(1,"ion-icon",1),s(2,"input",2),f("input",function(R){return o.handleInput(R)}),a(),x(3,fe,1,0,"ion-icon",3),a()),i&2&&(l(2),d("placeholder",o.placeholder())("disabled",o.disabled)("value",o.value),l(),v(o.value?3:-1))},dependencies:[se],encapsulation:2,changeDetection:0});let e=t;return e})();var g=(function(e){return e[e.NONE=0]="NONE",e[e.RECENT=1]="RECENT",e[e.SEARCHING=2]="SEARCHING",e})(g||{});var C=(()=>{let t=class t{constructor(n){this.api=n,this.searchControl=new X("",{nonNullable:!0}),this.debounceMs=250,this.debouncedQuery=le(this.searchControl.valueChanges.pipe(G(this.searchControl.value??""),V(this.debounceMs),z()),{initialValue:this.searchControl.value??""}),this.query=p(()=>this.debouncedQuery().trim()),this.state=T({dataSource:[],suggestions:[],recentSuggestions:[],loading:!1,error:null,query:"",mode:g.NONE}),this.reqToken=0,this.mode=p(()=>this.state().mode),this.count=p(()=>this.state().dataSource.length),this.error=p(()=>this.state().error),this.isEmpty=p(()=>!this.loading()&&this.count()===0&&!!this.queryText()),this.queryText=p(()=>this.state().query),this.hasResult=p(()=>!this.loading()&&this.count()>0),this.loading=p(()=>this.state().loading),this.suggestions=p(()=>this.state().suggestions),this.dataSource=p(()=>this.state().dataSource),this.onControlFocus=i=>{this.searchControl.value||(i?this.patch({mode:g.RECENT}):this.patch({mode:g.NONE}))},this.onSelectSuggestion=i=>{console.log(this),this.patch({loading:!0}),this.api.searchPost({q:this.searchControl.value,limit:10,offset:0}).subscribe(o=>{console.log("response with: ",this.searchControl.value),console.log("response: ",o),this.patch({loading:!1,mode:g.NONE,dataSource:o.data})})},L(()=>{let i=this.query(),o=++this.reqToken;if(!i){this.patch({loading:!1,error:null,query:"",mode:g.NONE}),this.onSelectSuggestion({keyword:""});return}this.patch({mode:g.SEARCHING,loading:!0}),this.api.suggestion(i).pipe().subscribe(c=>{console.log("Response: ",c),this.patch({loading:!1,suggestions:c.data})})})}patch(n){this.state.update(i=>q(q({},i),n))}reset(){this.reqToken++,this.searchControl.setValue("",{emitEvent:!0}),this.query.set(""),this.patch({dataSource:[],loading:!1,error:null,query:"",mode:g.NONE})}search(n){this.query.set((n??"").trim())}};t.\u0275fac=function(i){return new(i||t)(B(ae))},t.\u0275prov=H({token:t,factory:t.\u0275fac});let e=t;return e})();function Ce(e,t){if(e&1){let r=M();s(0,"ion-item",1),f("click",function(){let i=b(r).$implicit,o=h();return E(o.onSelect(i))}),F(1),a()}if(e&2){let r=t.$implicit;l(),P(" ",r.keyword||"-"," ")}}var pe=(()=>{let t=class t{constructor(){this.store=_(C),this.suggestions=this.store.suggestions,this.onSelect=this.store.onSelectSuggestion}ngOnInit(){}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=m({type:t,selectors:[["insta-search-suggestion"]],decls:3,vars:0,consts:[[1,"w-full","px-4"],[3,"click"]],template:function(i,o){i&1&&(s(0,"section",0),S(1,Ce,2,1,"ion-item",null,y),a()),i&2&&(l(),w(o.suggestions()))},dependencies:[N],encapsulation:2,changeDetection:0});let e=t;return e})();function _e(e,t){if(e&1){let r=M();s(0,"ion-item",1),f("click",function(){let i=b(r).$implicit,o=h();return E(o.onSelect(i))}),F(1),a()}if(e&2){let r=t.$implicit;l(),P(" ",r.keyword||"-"," ")}}var ue=(()=>{let t=class t{constructor(){this.store=_(C),this.suggestions=this.store.suggestions,this.onSelect=this.store.onSelectSuggestion}ngOnInit(){}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=m({type:t,selectors:[["insta-recent-suggestion"]],decls:3,vars:0,consts:[[1,"w-full","px-4"],[3,"click"]],template:function(i,o){i&1&&(s(0,"section",0),S(1,_e,2,1,"ion-item",null,y),a()),i&2&&(l(),w(o.suggestions()))},dependencies:[N],encapsulation:2,changeDetection:0});let e=t;return e})();function xe(e,t){if(e&1&&(s(0,"div",5),u(1,"img",8),a()),e&2){let r=t.$implicit;l(),d("src",r.url,O)}}function ve(e,t){if(e&1&&u(0,"img",8),e&2){let r=h(2).$implicit;d("src",r.big.url,O)}}function ye(e,t){if(e&1&&(s(0,"ion-col",3)(1,"div",4),S(2,xe,2,1,"div",5,y),a()(),s(4,"ion-col",6)(5,"div",7),x(6,ve,1,1,"img",8),a()()),e&2){let r=h().$implicit;l(2),w(r.small),l(4),v(r.big?6:-1)}}function Se(e,t){if(e&1&&u(0,"img",8),e&2){let r=h(2).$implicit;d("src",r.big.url,O)}}function we(e,t){if(e&1&&(s(0,"div",5),u(1,"img",8),a()),e&2){let r=t.$implicit;l(),d("src",r.url,O)}}function be(e,t){if(e&1&&(s(0,"ion-col",9)(1,"div",7),x(2,Se,1,1,"img",8),a()(),s(3,"ion-col",3)(4,"div",4),S(5,we,2,1,"div",5,y),a()()),e&2){let r=h().$implicit;l(2),v(r.big?2:-1),l(3),w(r.small)}}function Ee(e,t){if(e&1&&(s(0,"ion-row",2),x(1,ye,7,1)(2,be,7,1),a()),e&2){let r=t.$index;Q("row-odd",r%2===1),l(),v(r%2===0?1:2)}}var me=(()=>{let t=class t{constructor(){this._items=T([]),this.groups=p(()=>{let n=this._items(),i=[];for(let o=0;o<n.length;o+=5){let c=n.slice(o,o+5),R=c[0],he=c.slice(1,5);i.push({big:R,small:he})}return i})}set items(n){this._items.set(n??[])}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=m({type:t,selectors:[["insta-gallery"]],inputs:{items:"items"},decls:3,vars:0,consts:[["fixed","",1,"explore-grid"],[1,"explore-row",3,"row-odd"],[1,"explore-row"],["size","6","sizeLg","8",1,"cluster"],[1,"cluster-grid"],[1,"tile","tile-sm"],["size","6","sizeLg","4",1,"solo","pl-[4px]"],[1,"tile","tile-lg"],["alt","",3,"src"],["size","6","sizeLg","4",1,"solo","pr-[4px]"]],template:function(i,o){i&1&&(s(0,"ion-grid",0),S(1,Ee,3,3,"ion-row",1,y),a()),i&2&&(l(),w(o.groups()))},dependencies:[ie,oe,ee],styles:['@charset "UTF-8";.explore-grid[_ngcontent-%COMP%]{--ion-grid-padding: 0;--ion-grid-column-padding: 6px}.explore-row[_ngcontent-%COMP%]{margin-bottom:6px;align-items:stretch}.tile-lg[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;border-radius:8px;overflow:hidden;background:#f3f4f6;aspect-ratio:2/3}.cluster-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;grid-auto-rows:1fr;gap:0 2px;height:100%}.tile-sm[_ngcontent-%COMP%], .tile[_ngcontent-%COMP%]{position:relative;border-radius:8px;overflow:hidden;background:#f3f4f6}.tile-sm[_ngcontent-%COMP%]{aspect-ratio:1/1}.tile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .tile-lg[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .tile-sm[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;display:block}.cluster[_ngcontent-%COMP%], .solo[_ngcontent-%COMP%]{display:flex}.cluster[_ngcontent-%COMP%] > .cluster-grid[_ngcontent-%COMP%], .solo[_ngcontent-%COMP%] > .tile-lg[_ngcontent-%COMP%]{flex:1 1 auto}@media (max-width: 460px){.tile-lg[_ngcontent-%COMP%]{aspect-ratio:1/1}}@media (min-width: 431px) and (max-width: 1024px){ion-col[size="8"][_ngcontent-%COMP%], ion-col[size="4"][_ngcontent-%COMP%]{flex:0 0 50%!important;max-width:50%}.tile-lg[_ngcontent-%COMP%]{aspect-ratio:1/1}}@media (min-width: 1025px){ion-col[size="8"][_ngcontent-%COMP%]{flex:0 0 66.6667%!important;max-width:66.6667%}ion-col[size="4"][_ngcontent-%COMP%]{flex:0 0 33.3333%!important;max-width:33.3333%}.tile-lg[_ngcontent-%COMP%]{aspect-ratio:2/3}}'],changeDetection:0});let e=t;return e})();var de=(()=>{let t=class t{constructor(){this.store=_(C),this.dataSource=p(()=>this.store.dataSource().map((n,i)=>({url:n.media[0].url,type:"image",index:i})))}ngOnInit(){}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=m({type:t,selectors:[["insta-search-results"]],decls:2,vars:1,consts:[[1,"w-full","h-full","flex","flex-wrap","gap-2","px-4"],[3,"items"]],template:function(i,o){i&1&&(s(0,"section",0),u(1,"insta-gallery",1),a()),i&2&&(l(),d("items",o.dataSource()))},dependencies:[me],styles:["[_nghost-%COMP%]{width:100%;height:100%}"],changeDetection:0});let e=t;return e})();function Me(e,t){e&1&&u(0,"insta-search-results")}function Ie(e,t){e&1&&u(0,"insta-recent-suggestion")}function Oe(e,t){e&1&&u(0,"insta-search-suggestion")}var Tt=(()=>{let t=class t{constructor(){this.store=_(C),this.mode=this.store.mode,this.searchControl=this.store.searchControl,this.onControlFocus=this.store.onControlFocus,this.searchMode=g}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=m({type:t,selectors:[["insta-explore"]],features:[k([C])],decls:9,vars:3,consts:[[3,"translucent"],[1,"py-4"],[3,"focused","blurred","formControl"],[1,"py-4","explore-content"]],template:function(i,o){if(i&1&&(s(0,"ion-header",0)(1,"ion-toolbar")(2,"section",1)(3,"insta-search-input",2),f("focused",function(){return o.onControlFocus(!0)})("blurred",function(){return o.onControlFocus(!1)}),a()()()(),s(4,"ion-content")(5,"section",3),x(6,Me,1,0,"insta-search-results")(7,Ie,1,0,"insta-recent-suggestion")(8,Oe,1,0,"insta-search-suggestion"),a()()),i&2){let c;d("translucent",!0),l(3),d("formControl",o.searchControl),l(3),v((c=o.mode())===o.searchMode.NONE?6:c===o.searchMode.RECENT?7:8)}},dependencies:[de,ce,Z,K,Y,pe,ue,te,ne,re],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .explore-content[_ngcontent-%COMP%]{height:calc(100% - 32px)}ion-toolbar[_ngcontent-%COMP%]{--border-color: var(--ion-background-color) !important}"],changeDetection:0});let e=t;return e})();export{Tt as ExploreComponent};
